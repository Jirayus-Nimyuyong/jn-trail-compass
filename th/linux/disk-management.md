# การใช้ Disk Management ใน Linux

## บทนำ

การจัดการดิสก์ (Disk Management) เป็นหนึ่งในงานสำคัญในการดูแลรักษาระบบปฏิบัติการ Linux ซึ่งรวมถึงการจัดการพาร์ติชัน การตรวจสอบสถานะของดิสก์ การจัดสรรพื้นที่ดิสก์ การติดตั้งและย้ายข้อมูล และการตรวจสอบปัญหาของดิสก์ ในบทนี้เราจะเรียนรู้วิธีการใช้คำสั่งต่างๆ ที่ใช้ในการจัดการดิสก์ในระบบ Linux

## 1. การตรวจสอบสถานะของดิสก์

### 1.1 การใช้ `df`

คำสั่ง `df` ใช้ในการแสดงข้อมูลเกี่ยวกับพื้นที่ที่ใช้และพื้นที่ที่ว่างอยู่ในระบบไฟล์

```bash
df -h
```

- `-h` (human-readable) จะทำให้ผลลัพธ์แสดงพื้นที่ในหน่วยที่เข้าใจง่าย เช่น KB, MB, GB เป็นต้น

### 1.2 การใช้ `lsblk`

คำสั่ง `lsblk` ใช้ในการแสดงรายละเอียดเกี่ยวกับบล็อกอุปกรณ์ เช่น ดิสก์ พาร์ติชัน และข้อมูลต่างๆ

```bash
lsblk
```

คำสั่งนี้จะแสดงข้อมูลที่เกี่ยวข้องกับดิสก์และพาร์ติชันที่เชื่อมต่ออยู่ในระบบ

### 1.3 การใช้ `fdisk`

คำสั่ง `fdisk` ใช้สำหรับการจัดการพาร์ติชันบนดิสก์ที่มีระบบไฟล์แบบ MBR (Master Boot Record)

```bash
sudo fdisk -l
```

คำสั่งนี้จะแสดงรายการของดิสก์ทั้งหมดที่เชื่อมต่ออยู่ พร้อมกับข้อมูลเกี่ยวกับพาร์ติชันต่างๆ

## 2. การสร้างและการลบพาร์ติชัน

### 2.1 การสร้างพาร์ติชันใหม่

ใช้คำสั่ง `fdisk` หรือ `parted` เพื่อสร้างพาร์ติชันใหม่

#### 2.1.1 การสร้างพาร์ติชันด้วย `fdisk`

```bash
sudo fdisk /dev/sda
```

หลังจากเข้ามาในเครื่องมือ `fdisk` ให้เลือกคำสั่งต่อไปนี้:

- กด `n` เพื่อสร้างพาร์ติชันใหม่
- กด `p` เพื่อเลือกพาร์ติชันประเภท primary
- ระบุขนาดพาร์ติชันตามต้องการ

หลังจากสร้างพาร์ติชันเสร็จแล้ว ให้กด `w` เพื่อบันทึกการเปลี่ยนแปลง

### 2.2 การลบพาร์ติชัน

หากต้องการลบพาร์ติชันให้ใช้คำสั่ง `fdisk` เช่นเดียวกัน:

```bash
sudo fdisk /dev/sda
```

- กด `d` เพื่อเลือกลบพาร์ติชัน
- ระบุหมายเลขของพาร์ติชันที่ต้องการลบ
- กด `w` เพื่อบันทึกการเปลี่ยนแปลง

## 3. การจัดการไฟล์ระบบ

### 3.1 การสร้างระบบไฟล์ใหม่

การสร้างระบบไฟล์ใหม่ในพาร์ติชันสามารถทำได้โดยใช้คำสั่ง `mkfs`

#### 3.1.1 การสร้างระบบไฟล์ EXT4

```bash
sudo mkfs.ext4 /dev/sda1
```

คำสั่งนี้จะสร้างระบบไฟล์ EXT4 ในพาร์ติชัน `/dev/sda1`

#### 3.1.2 การสร้างระบบไฟล์ XFS

```bash
sudo mkfs.xfs /dev/sda1
```

คำสั่งนี้จะสร้างระบบไฟล์ XFS ในพาร์ติชัน `/dev/sda1`

### 3.2 การตรวจสอบและซ่อมแซมระบบไฟล์

หากต้องการตรวจสอบและซ่อมแซมระบบไฟล์ให้ใช้คำสั่ง `fsck`

```bash
sudo fsck /dev/sda1
```

คำสั่งนี้จะตรวจสอบและซ่อมแซมระบบไฟล์ในพาร์ติชัน `/dev/sda1`

## 4. การมอนต์ (Mount) และการยกเลิกมอนต์ (Unmount)

### 4.1 การมอนต์ดิสก์

การมอนต์ดิสก์หมายถึงการเชื่อมต่อพาร์ติชันกับไดเรกทอรีในระบบไฟล์ของคุณ

```bash
sudo mount /dev/sda1 /mnt
```

คำสั่งนี้จะมอนต์พาร์ติชัน `/dev/sda1` ไปที่ไดเรกทอรี `/mnt`

### 4.2 การยกเลิกมอนต์ดิสก์

การยกเลิกมอนต์ดิสก์จะทำให้พาร์ติชันไม่สามารถเข้าถึงได้ชั่วคราว

```bash
sudo umount /mnt
```

คำสั่งนี้จะยกเลิกการมอนต์จากไดเรกทอรี `/mnt`

## 5. การเพิ่มและการลบดิสก์จากระบบ

### 5.1 การเพิ่มดิสก์

การเพิ่มดิสก์สามารถทำได้โดยการเชื่อมต่อดิสก์ใหม่เข้าสู่เครื่อง โดยเครื่องจะต้องทำการตรวจสอบอุปกรณ์ใหม่ด้วยคำสั่ง `lsblk` หรือ `fdisk`

### 5.2 การลบดิสก์

หากต้องการลบดิสก์ออกจากระบบให้ใช้คำสั่ง `fdisk` หรือ `parted` เพื่อแก้ไขพาร์ติชันและทำการลบพาร์ติชันจากดิสก์

## 6. การจัดการดิสก์แบบ LVM (Logical Volume Management)

LVM ช่วยให้การจัดการดิสก์และพาร์ติชันสามารถทำได้ยืดหยุ่นมากขึ้น

### 6.1 การสร้าง Physical Volume (PV)

```bash
sudo pvcreate /dev/sda
```

### 6.2 การสร้าง Volume Group (VG)

```bash
sudo vgcreate my_volume_group /dev/sda
```

### 6.3 การสร้าง Logical Volume (LV)

```bash
sudo lvcreate -L 10G -n my_logical_volume my_volume_group
```

### 6.4 การติดตั้ง Logical Volume

```bash
sudo mount /dev/my_volume_group/my_logical_volume /mnt
```

## สรุป

การจัดการดิสก์ใน Linux เป็นทักษะพื้นฐานที่สำคัญในการดูแลระบบ การทำความเข้าใจเครื่องมือเช่น `fdisk`, `lsblk`, `mount`, `mkfs`, `fsck` และการใช้ LVM จะช่วยให้การจัดการดิสก์ในระบบ Linux เป็นเรื่องง่ายและมีประสิทธิภาพมากขึ้น